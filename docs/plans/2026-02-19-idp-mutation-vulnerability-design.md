# IDP mutation vulnerability framework — design document

## problem statement

existing variant effect predictors (AlphaMissense, EVE, CADD, PolyPhen) perform poorly on intrinsically disordered regions because they rely on conservation and structural context — both weak in IDRs. we have IDP-specific features (maturation grammar, condensate physics, amyloid propensity) that may capture vulnerability patterns these tools miss.

**question**: what local sequence and network features predict whether a missense mutation in an IDP-related gene is pathogenic?

## data

### variant sources
- **pathogenic**: ClinVar pathogenic + likely pathogenic missense variants (≥1 star review)
- **benign**: ClinVar benign + likely benign, supplemented by gnomAD common variants (MAF > 0.001)
- **estimated**: ~2,100 pathogenic + ~8,000 benign across 23 genes

### genes (23 total)

original 16 IDP genes (SNCA, APP, MAPT, TARDBP, FUS, HNRNPA1, PRNP, HTT, TIA1, EWSR1, TAF15, HNRNPA2B1, ATXN3, DDX4, NPM1, IAPP) + 7 new (SOD1, TTR, LMNA, VCP, AR, SQSTM1, CRYAB).

excluded: ATXN1, ATXN2, LYZ (too few pathogenic missense — disease driven by repeat expansion, not point mutations).

### protein sequences
UniProt canonical sequences for all 23 genes. used for local feature computation.

### disorder annotations
IUPred2A or MobiDB for per-residue disorder probability. defines IDR/structured boundary.

## features (~35-40 per mutation position)

### local window features (±15 residues around mutation site)
- mean hydrophobicity (Kyte-Doolittle)
- local charge density (fraction charged)
- local aromatic density
- local β-sheet propensity (Chou-Fasman)
- local disorder score (IUPred)
- grammar score at position: p_lock, p_pi, p_polar (from sliding window)
- APR overlap: does the mutation fall within an aggregation-prone region?
- sticker site: is the position a Tyr/Phe/Trp sticker in an LCD?

### mutation-specific features
- amino acid property change category: charge flip, hydrophobic→polar, size change, etc.
- BLOSUM62 substitution score
- Grantham distance (physicochemical difference)
- ESM2 log-likelihood ratio at the specific position (WT vs mutant)
- does the mutation create or destroy a proline (β-breaker)?
- does the mutation introduce or remove a charge?

### regional annotation
- in_IDR: binary (IUPred > 0.5)
- in_LCD: binary (low-complexity region from SEG or manual annotation)
- in_functional_domain: binary + domain_type (NLS, RRM, zinc finger, PrLD, polyQ, etc.)
- relative position within IDR (N-terminal, C-terminal, or central)

### protein-level context
- total disorder fraction
- mechanism class (from our existing classification)
- protein length
- number of LCDs
- condensate membership (from PhaSepDB / DrLLPS)

### network features (per protein)
- STRING interaction degree
- stress granule component? (binary)
- expression breadth (number of tissues, GTEx)

## three modeling approaches (all tested, best wins)

### approach A: position-level feature classifier
- features: all handcrafted features above (~35-40)
- model: gradient boosted trees (XGBoost) — handles mixed feature types, provides feature importance
- evaluation: leave-one-gene-out cross-validation (LOGO-CV)
- output: AUROC, AUPRC, per-gene AUROC, feature importance ranking

### approach B: IDR vs structured stratification
- same features as A
- additional analysis: train separate models for IDR positions vs structured positions
- compare feature importances between the two — do IDP-specific features (grammar, condensate) matter more in IDRs?
- this is approach A with a stratified post-hoc analysis layer

### approach C: ESM2 embedding-based
- features: ESM2 per-residue embeddings (1280-dim) at mutation position + ±5 context residues
- optionally: concatenate handcrafted features from A
- model: small neural network head (2-layer MLP) or gradient boosted trees on ESM2 PCA
- provides upper bound on what sequence information can capture
- black box but powerful

## evaluation

### primary metric
AUROC on leave-one-gene-out cross-validation. this is the honest test — can the model predict pathogenicity in a gene it has never seen?

### secondary metrics
- AUPRC (handles class imbalance)
- per-gene AUROC (which genes does the model struggle with?)
- calibration (are predicted probabilities reliable?)

### baselines to compare against
1. random (AUROC = 0.5)
2. ESM2 LLR alone (single feature baseline)
3. conservation score alone (from MSA)
4. AlphaMissense predictions on same variant set (if accessible)
5. disorder score alone (are pathogenic variants simply in ordered regions?)

### critical controls
- **gene-level confounding check**: if LOGO-CV drops dramatically, the model is learning gene identity, not position-level features
- **IDR enrichment check**: are pathogenic variants enriched in IDRs or structured domains? this null hypothesis must be tested first
- **class balance**: use stratified sampling or class weights to handle ~3:1 benign:pathogenic imbalance

## stage 2: mechanism of pathogenicity (exploratory)

among pathogenic variants only, predict WHY the mutation causes disease:
- disrupts condensate dynamics (e.g., D262V hnRNPA1)
- promotes amyloid (e.g., A53T α-syn)
- breaks localization signal (e.g., P525L FUS)
- disrupts protein-protein interaction
- loss of function / destabilization

this requires manual annotation of ~100-200 pathogenic variants from literature. smaller n, harder labels, but biologically more interesting. exploratory, not primary.

## implementation plan (high-level)

1. **data collection** — download ClinVar variant_summary, filter for 23 genes, get missense variants, get UniProt sequences, run IUPred disorder prediction
2. **feature engineering** — compute all local/mutation/regional/protein features for every variant position
3. **modeling** — train approaches A, B, C with LOGO-CV
4. **evaluation** — compare AUROC, feature importance, per-gene performance
5. **interpretation** — what makes IDP mutations pathogenic? which features are unique to our framework vs existing predictors?

## success criteria

- LOGO-CV AUROC > 0.70 for at least one approach (better than disorder-score-alone baseline)
- at least 2 IDP-specific features (grammar, condensate) in the top 10 feature importance
- clear difference in feature importance between IDR and structured positions
- the framework adds value beyond what AlphaMissense/ESM2 already captures

## risks and mitigations

| risk | mitigation |
|------|-----------|
| ClinVar label noise (VUS, low-star) | filter ≥1 star review status, sensitivity analysis with ≥2 stars |
| gene-level confounding | LOGO-CV is the primary evaluation; also test random gene split |
| class imbalance (3:1 benign:pathogenic) | class weights, AUPRC as secondary metric |
| TARDBP cancer variants contaminating ALS set | filter by condition (neurodegenerative only) |
| IDR features may not help (structured domain mutations dominate) | approach B explicitly tests this; if true, that's itself a finding |
| small per-gene n for some genes | group by mechanism class for genes with <20 pathogenic variants |
